{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport { create } from 'zustand';\nimport axios from 'axios';\nimport { API_URL } from \"../config\";\nimport { useAuthStore } from \"./auth\";\nexport var useVotesStore = create(function (set, get) {\n  return {\n    sessions: [],\n    currentSession: null,\n    loading: false,\n    error: null,\n    votes: {},\n    loadSessions: function () {\n      var _loadSessions = _asyncToGenerator(function* () {\n        try {\n          set({\n            loading: true,\n            error: null\n          });\n          var _useAuthStore$getStat = useAuthStore.getState(),\n            token = _useAuthStore$getStat.token;\n          var response = yield axios.get(`${API_URL}/api/votes/sessions`, {\n            headers: {\n              Authorization: `Bearer ${token}`\n            }\n          });\n          set({\n            sessions: response.data,\n            loading: false\n          });\n        } catch (error) {\n          set({\n            error: error instanceof Error ? error.message : 'Failed to load sessions',\n            loading: false\n          });\n        }\n      });\n      function loadSessions() {\n        return _loadSessions.apply(this, arguments);\n      }\n      return loadSessions;\n    }(),\n    createSession: function () {\n      var _createSession = _asyncToGenerator(function* (name, description) {\n        try {\n          set({\n            loading: true,\n            error: null\n          });\n          var _useAuthStore$getStat2 = useAuthStore.getState(),\n            token = _useAuthStore$getStat2.token;\n          var response = yield axios.post(`${API_URL}/api/votes/sessions`, {\n            name: name,\n            description: description\n          }, {\n            headers: {\n              Authorization: `Bearer ${token}`\n            }\n          });\n          var newSession = response.data;\n          set(function (state) {\n            return {\n              sessions: [].concat(_toConsumableArray(state.sessions), [newSession]),\n              loading: false\n            };\n          });\n          return newSession;\n        } catch (error) {\n          set({\n            error: error instanceof Error ? error.message : 'Failed to create session',\n            loading: false\n          });\n          throw error;\n        }\n      });\n      function createSession(_x, _x2) {\n        return _createSession.apply(this, arguments);\n      }\n      return createSession;\n    }(),\n    loadSession: function () {\n      var _loadSession = _asyncToGenerator(function* (sessionId) {\n        try {\n          set({\n            loading: true,\n            error: null\n          });\n          var _useAuthStore$getStat3 = useAuthStore.getState(),\n            token = _useAuthStore$getStat3.token;\n          var response = yield axios.get(`${API_URL}/api/votes/sessions/${sessionId}`, {\n            headers: {\n              Authorization: `Bearer ${token}`\n            }\n          });\n          set({\n            currentSession: response.data,\n            loading: false\n          });\n        } catch (error) {\n          set({\n            error: error instanceof Error ? error.message : 'Failed to load session',\n            loading: false\n          });\n        }\n      });\n      function loadSession(_x3) {\n        return _loadSession.apply(this, arguments);\n      }\n      return loadSession;\n    }(),\n    submitVote: function () {\n      var _submitVote = _asyncToGenerator(function* (sessionId, itemId, vote) {\n        try {\n          set({\n            loading: true,\n            error: null\n          });\n          var _useAuthStore$getStat4 = useAuthStore.getState(),\n            token = _useAuthStore$getStat4.token;\n          yield axios.post(`${API_URL}/api/votes/sessions/${sessionId}/vote`, {\n            itemId: itemId,\n            vote: vote\n          }, {\n            headers: {\n              Authorization: `Bearer ${token}`\n            }\n          });\n          set(function (state) {\n            return {\n              votes: _objectSpread(_objectSpread({}, state.votes), {}, _defineProperty({}, sessionId, [].concat(_toConsumableArray(state.votes[sessionId] || []), [{\n                itemId: itemId,\n                vote: vote\n              }]))),\n              loading: false\n            };\n          });\n          var currentSession = get().currentSession;\n          if ((currentSession == null ? void 0 : currentSession.id) === sessionId) {\n            yield get().loadSession(sessionId);\n          }\n        } catch (error) {\n          set({\n            error: error instanceof Error ? error.message : 'Failed to submit vote',\n            loading: false\n          });\n        }\n      });\n      function submitVote(_x4, _x5, _x6) {\n        return _submitVote.apply(this, arguments);\n      }\n      return submitVote;\n    }(),\n    clearError: function clearError() {\n      return set({\n        error: null\n      });\n    }\n  };\n});","map":{"version":3,"names":["create","axios","API_URL","useAuthStore","useVotesStore","set","get","sessions","currentSession","loading","error","votes","loadSessions","_loadSessions","_asyncToGenerator","_useAuthStore$getStat","getState","token","response","headers","Authorization","data","Error","message","apply","arguments","createSession","_createSession","name","description","_useAuthStore$getStat2","post","newSession","state","concat","_toConsumableArray","_x","_x2","loadSession","_loadSession","sessionId","_useAuthStore$getStat3","_x3","submitVote","_submitVote","itemId","vote","_useAuthStore$getStat4","_objectSpread","_defineProperty","id","_x4","_x5","_x6","clearError"],"sources":["E:/fashion-tinder/frontend/src/store/votes.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport axios from 'axios';\r\nimport { API_URL } from '../config';\r\nimport { useAuthStore } from './auth';\r\n\r\nexport interface VoteSession {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  createdAt: Date;\r\n  participants: {\r\n    id: string;\r\n    username: string;\r\n    name: string;\r\n  }[];\r\n  items: {\r\n    id: string;\r\n    name: string;\r\n    brand: string;\r\n    price: number;\r\n    currency: string;\r\n    images: string[];\r\n    tags: string[];\r\n    gender: string | null;\r\n    season: string | null;\r\n  }[];\r\n  status: 'active' | 'completed';\r\n  creatorId: string;\r\n  results?: {\r\n    itemId: string;\r\n    votes: number;\r\n  }[];\r\n}\r\n\r\ninterface Vote {\r\n  itemId: string;\r\n  vote: boolean;\r\n}\r\n\r\ninterface VotesState {\r\n  sessions: VoteSession[];\r\n  currentSession: VoteSession | null;\r\n  loading: boolean;\r\n  error: string | null;\r\n  votes: Record<string, Vote[]>; // sessionId -> votes[]\r\n  loadSessions: () => Promise<void>;\r\n  createSession: (name: string, description?: string) => Promise<VoteSession>;\r\n  loadSession: (sessionId: string) => Promise<void>;\r\n  submitVote: (sessionId: string, itemId: string, vote: boolean) => Promise<void>;\r\n  clearError: () => void;\r\n}\r\n\r\nexport const useVotesStore = create<VotesState>((set, get) => ({\r\n  sessions: [],\r\n  currentSession: null,\r\n  loading: false,\r\n  error: null,\r\n  votes: {},\r\n\r\n  loadSessions: async () => {\r\n    try {\r\n      set({ loading: true, error: null });\r\n      const { token } = useAuthStore.getState();\r\n      const response = await axios.get(`${API_URL}/api/votes/sessions`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      set({ sessions: response.data, loading: false });\r\n    } catch (error) {\r\n      set({\r\n        error: error instanceof Error ? error.message : 'Failed to load sessions',\r\n        loading: false,\r\n      });\r\n    }\r\n  },\r\n\r\n  createSession: async (name: string, description?: string) => {\r\n    try {\r\n      set({ loading: true, error: null });\r\n      const { token } = useAuthStore.getState();\r\n      const response = await axios.post(\r\n        `${API_URL}/api/votes/sessions`,\r\n        {\r\n          name,\r\n          description,\r\n        },\r\n        {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        }\r\n      );\r\n      const newSession = response.data;\r\n      set((state) => ({\r\n        sessions: [...state.sessions, newSession],\r\n        loading: false,\r\n      }));\r\n      return newSession;\r\n    } catch (error) {\r\n      set({\r\n        error: error instanceof Error ? error.message : 'Failed to create session',\r\n        loading: false,\r\n      });\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  loadSession: async (sessionId: string) => {\r\n    try {\r\n      set({ loading: true, error: null });\r\n      const { token } = useAuthStore.getState();\r\n      const response = await axios.get(\r\n        `${API_URL}/api/votes/sessions/${sessionId}`,\r\n        {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        }\r\n      );\r\n      set({ currentSession: response.data, loading: false });\r\n    } catch (error) {\r\n      set({\r\n        error: error instanceof Error ? error.message : 'Failed to load session',\r\n        loading: false,\r\n      });\r\n    }\r\n  },\r\n\r\n  submitVote: async (sessionId: string, itemId: string, vote: boolean) => {\r\n    try {\r\n      set({ loading: true, error: null });\r\n      const { token } = useAuthStore.getState();\r\n      await axios.post(\r\n        `${API_URL}/api/votes/sessions/${sessionId}/vote`,\r\n        {\r\n          itemId,\r\n          vote,\r\n        },\r\n        {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        }\r\n      );\r\n\r\n      // Update local votes state\r\n      set((state) => ({\r\n        votes: {\r\n          ...state.votes,\r\n          [sessionId]: [\r\n            ...(state.votes[sessionId] || []),\r\n            { itemId, vote },\r\n          ],\r\n        },\r\n        loading: false,\r\n      }));\r\n\r\n      // Reload session to get updated results if needed\r\n      const currentSession = get().currentSession;\r\n      if (currentSession?.id === sessionId) {\r\n        await get().loadSession(sessionId);\r\n      }\r\n    } catch (error) {\r\n      set({\r\n        error: error instanceof Error ? error.message : 'Failed to submit vote',\r\n        loading: false,\r\n      });\r\n    }\r\n  },\r\n\r\n  clearError: () => set({ error: null }),\r\n}));"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}